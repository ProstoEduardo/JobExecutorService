Сервис реализован по заданию https://gist.github.com/stas29a/91945ed4e32e5b333573d8ceb12f3133

В сервисе не было уточнений про БД и заданиче требует большого количества уточнений, от которых может меняться реализация.
В текущем решение было максимально упрощено, и показано общая концепция решения.
Выполнением задачи будет заниматься отдельный процесс, пользователь может лишь инициаровать задачу.
ТГ @Prosto_Eduardo